define("tiny_cursive/append_fourm_post",["jquery","core/ajax","core/str","core/templates","./replay","./analytic_button","./analytic_events"],(function($,AJAX,str,templates,Replay,analyticButton,AnalyticEvents){const replayInstances={};window.video_playback=function(mid,filepath){if(""!==filepath){const replay=new Replay("content"+mid,filepath,10,!1,"player_"+mid);replayInstances[mid]=replay}else templates.render("tiny_cursive/no_submission").then((html=>{$("#content"+mid).html(html)})).catch((e=>window.console.error(e)));return!1};var usersTable={init:function(score_setting,showcomment){str.get_strings([{key:"field_require",component:"tiny_cursive"}]).done((function(){usersTable.getToken(score_setting,showcomment)}))},getToken:function(score_setting,showcomment){$("#page-mod-forum-discuss").find("article").get().forEach((function(entry){$(document).ready((function(){var replyButton=$('a[data-region="post-action"][title="Reply"]');replyButton.length>0&&replyButton.on("click",(function(event){event.preventDefault();var url=$(this).attr("href");window.location.href=url}))}));var ids=$("#"+entry.id).data("post-id"),anchorTag=$('a.nav-link.active.active_tree_node[href*="mod/forum/view.php?id="]'),cmid=0;if(anchorTag.length>0){var hrefValue=anchorTag.attr("href");cmid=hrefValue.match(/id=(\d+)/)[1]}let args={id:ids,modulename:"forum",cmid:cmid},com=AJAX.call([{methodname:"cursive_get_forum_comment_link",args:args}]);return com[0].done((function(json){var data=JSON.parse(json),filepath="";if(data.data.filename&&(filepath=data.data.filename),filepath){let analytic_button_div=document.createElement("div");if(analytic_button_div.append(analyticButton(ids)),analytic_button_div.classList.add("text-center","mt-2"),analytic_button_div.dataset.region="analytic-div"+ids,$("#"+entry.id).find("#post-content-"+ids).append(analytic_button_div),"comments"!=data.usercomment&&parseInt(showcomment)){let comments="";data.usercomment.forEach((element=>{comments+='<div class="border-bottom p-3 text-primary" style="font-weight:600;">'+element.usercomment+"</div>"})),$("#"+entry.id).find("#post-content-"+ids).prepend($("<div>").addClass("tiny_cursive-quiz-references rounded").append(comments))}let myEvents=new AnalyticEvents;var context={tabledata:data.data,formattime:myEvents.formatedTime(data.data),page:score_setting,userid:ids};let authIcon=myEvents.authorshipStatus(data.data.first_file,data.data.score,score_setting);myEvents.createModal(ids,context,"",authIcon),myEvents.analytics(ids,templates,context,"",replayInstances,authIcon),myEvents.checkDiff(ids,data.data.file_id,"",replayInstances),myEvents.replyWriting(ids,filepath,"",replayInstances),myEvents.quality(ids,templates,context,"",replayInstances,cmid)}})),com.usercomment}))}};return usersTable}));

//# sourceMappingURL=append_fourm_post.min.js.map